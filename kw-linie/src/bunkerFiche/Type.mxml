<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas 
	xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:components="components.*">
	
	<mx:Script>
		<![CDATA[
			import util.StringUtils;
			import util.BindingUtils;
			import referenceData.BunkerSchietgatenHolder;
			import referenceData.BunkerExtHolder;
			import referenceData.BunkerCodeHolder;
			import referenceData.BunkerTypeHolder;
			
			[Bindable]
			private var types: Object = BunkerTypeHolder.getInstance();

			[Bindable]
			private var codes: Object = BunkerCodeHolder.getInstance();

			[Bindable]
			private var exts: Object = BunkerExtHolder.getInstance();

			[Bindable]
			private var schietgaten: Object = BunkerSchietgatenHolder.getInstance();
			
			public function bunkerNummer(code: String, nr: int, ext: String) : String {
				var padded: String = StringUtils.leftPadding(nr.toString(), 2);
				return StringUtils.join([code, padded, ext]);
			}
			
			public function bind(bunker: Object) : void {
				bunker.bunker_id = BindingUtils.textinputToInteger(ti_bunker_id);
				bunker.type = BindingUtils.comboboxToString(cb_type);
				bunker.code = BindingUtils.comboboxToString(cb_code);
				bunker.nr = BindingUtils.numericStepperToInteger(ns_nr);
				bunker.ext = BindingUtils.comboboxToString(cb_ext);
				bunker.schietgaten = BindingUtils.comboboxToString(cb_schietgaten);
				bunker.aanwezig = BindingUtils.comboBoxExToString(cb_aanwezig);
				//
				bunker.nummer = bunkerNummer(bunker.code, bunker.nr, bunker.ext);
			}
		]]>
	</mx:Script>
	
	<mx:ArrayCollection id="dp_aanwezig">
		<mx:Object label="Aanwezig" value="aanwezig" />
		<mx:Object label="Afwezig" value="afwezig" />
		<mx:Object label="Afgebroken" value="afgebroken" />
		<mx:Object label="Nooit gebouwd" value="nooit gebouwd" />
		<mx:Object label="Onbekend" value="" />
	</mx:ArrayCollection>
	
	<mx:Form x="0" y="0">
		<mx:FormItem label="Uniek Nummer (ID)">
			<mx:TextInput  
				id="ti_bunker_id"
				width="96" 
				text="{data.bunker_id}"
				editable="false"/>
		</mx:FormItem>
		<mx:FormItem label="Type">
			<components:ComboBoxEx 
				id="cb_type"
				dataProvider="{types.data}" 
				labelField="type"
				valueField="type"
				selectedValue="{data.type}"
				width="200"/>
		</mx:FormItem>
		<mx:FormItem label="Code">
			<components:ComboBoxEx 
				id="cb_code"
				dataProvider="{codes.data}" 
				labelField="code"
				valueField="code"
				selectedValue="{data.code}"
				width="200"/>
		</mx:FormItem>
		<mx:FormItem label="Nummer">
			<mx:NumericStepper 
				id="ns_nr"
				minimum="1" 
				maximum="99"
				value="{data.nr}"/>
		</mx:FormItem>
		<mx:FormItem label="Nummer extensie">
			<components:ComboBoxEx 
				id="cb_ext"
				dataProvider="{exts.data}" 
				labelField="ext"
				valueField="ext"
				selectedValue="{data.ext}"
				width="200"/>
		</mx:FormItem>
		<mx:FormItem label="Schietgaten">
			<components:ComboBoxEx 
				id="cb_schietgaten"
				dataProvider="{schietgaten.data}" 
				labelField="schietgaten"
				valueField="schietgaten"
				selectedValue="{data.schietgaten}"
				width="200"/>
		</mx:FormItem>
		<mx:FormItem label="Nog aanwezig">
			<components:ComboBoxEx 
				id="cb_aanwezig"
				dataProvider="{dp_aanwezig}" 
				labelField="label"
				valueField="value"
				selectedValue="{data.aanwezig}"
				width="200"/>
		</mx:FormItem>
	</mx:Form>
	
</mx:Canvas>
